<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="security">
	
	<select id="loadUserByUsername" resultMap="userResultMap">
		SELECT U.*, P.IMAGE_URL
		FROM USER_TB U
		LEFT JOIN PROFILE USING(USER_NUM)
		WHERE USER_ID = #{userId}
	</select>
	
	<resultMap type="com.kh.itda.security.model.vo.UserExt" id="userResultMap">
		<id column="USER_NUM" property="userNum" />
		<result column="USER_ID" property="userId" />
		<result column="USER_PWD" property="userPwd" />
		<result column="NICKNAME" property="nickName" />
		<result column="EMAIL" property="email" />
		<result column="PHONE" property="phone" />
		<result column="BIRTH" property="birth" />
		<result column="ADDRESS" property="adress" />
		<result column="CREATE_DATE" property="createDate" />
		<result column="IMAGE_URL" property="imageUrl" />
		<collection property="authorities" 
		javaType="arraylist"
		ofType="org.springframework.security.core.authority.SimpleGrantedAuthority"
		column="USER_ID"
		select="selectAuthorities"
		/>
	</resultMap>
	
</mapper>


























